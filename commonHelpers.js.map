{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport axios from 'axios';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst PIXABEY_API = '41780713-d9d59fd8c4b13cd5ac9a220da';\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreWrapper = document.querySelector('.load-more-wrapper');\nconst loaderWrapper = document.querySelector('.loader-wrapper');\nconst loadMoreBtn = document.querySelector('button.load-more');\nconst form = document.querySelector('.search-form');\nconst noMore = document.querySelector('.no-more');\nconst gallery = new SimpleLightbox('.gallery li a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet images = [];\nlet page = 1;\nlet oldQuery = '';\nconst perPage = 40;\n\nasync function searchImages(isNewSearch = false) {\n  const query = document.querySelector('.search-form input').value.trim();\n\n  if (!query) {\n    return iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query',\n    });\n  }\n\n  if (oldQuery !== query || isNewSearch) {\n    images = [];\n    page = 1;\n    oldQuery = query;\n  } else {\n    page += 1;\n  }\n\n  noMore.classList.remove('is-active');\n  loadMoreWrapper.classList.add('is-hidden');\n  loaderWrapper.classList.add('is-active');\n\n  try {\n    images = [];\n    const response = await axios.get(`https://pixabay.com/api/`, {\n      params: {\n        key: PIXABEY_API,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: perPage,\n        page,\n      },\n    });\n\n    images.push(...response.data.hits);\n\n    loaderWrapper.classList.remove('is-active');\n    loadMoreWrapper.classList.remove('is-hidden');\n\n    if (response.data.hits.length < perPage) {\n      loadMoreWrapper.classList.add('is-hidden');\n      noMore.classList.add('is-active');\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong, try again later!',\n    });\n    loaderWrapper.classList.remove('is-active');\n  }\n}\n\nasync function buildGallery(isNewSearch = false) {\n  const markup = images\n    .map(img => {\n      return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${img.webformatURL}\"\n                alt=\"${img.tags}\"\n            />\n            </a>\n        </li>\n        `;\n    })\n    .join('');\n\n  if (isNewSearch) {\n    galleryEl.innerHTML = markup;\n  } else {\n    galleryEl.insertAdjacentHTML('beforeend', markup);\n  }\n\n  if (images.length === 0) {\n    return iziToast.error({\n      title: 'Error',\n      message: 'No images found for this request',\n    });\n  }\n\n  gallery.refresh();\n\n  const cardHeight = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function loadImages(isNewSearch = false) {\n  await searchImages(isNewSearch);\n  await buildGallery(isNewSearch);\n}\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  loadImages(true);\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loadImages();\n});\n"],"names":["PIXABEY_API","galleryEl","loadMoreWrapper","loaderWrapper","loadMoreBtn","form","noMore","gallery","SimpleLightbox","images","page","oldQuery","perPage","searchImages","isNewSearch","query","iziToast","response","axios","buildGallery","markup","img","cardHeight","loadImages","event"],"mappings":"owBAMA,MAAMA,EAAc,qCACdC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAkB,SAAS,cAAc,oBAAoB,EAC7DC,EAAgB,SAAS,cAAc,iBAAiB,EACxDC,EAAc,SAAS,cAAc,kBAAkB,EACvDC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAS,SAAS,cAAc,UAAU,EAC1CC,EAAU,IAAIC,EAAe,gBAAiB,CAClD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,IAAIC,EAAS,CAAA,EACTC,EAAO,EACPC,EAAW,GACf,MAAMC,EAAU,GAEhB,eAAeC,EAAaC,EAAc,GAAO,CAC/C,MAAMC,EAAQ,SAAS,cAAc,oBAAoB,EAAE,MAAM,OAEjE,GAAI,CAACA,EACH,OAAOC,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,6BACf,CAAK,EAGCL,IAAaI,GAASD,GACxBL,EAAS,CAAA,EACTC,EAAO,EACPC,EAAWI,GAEXL,GAAQ,EAGVJ,EAAO,UAAU,OAAO,WAAW,EACnCJ,EAAgB,UAAU,IAAI,WAAW,EACzCC,EAAc,UAAU,IAAI,WAAW,EAEvC,GAAI,CACFM,EAAS,CAAA,EACT,MAAMQ,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKlB,EACL,EAAGe,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUH,EACV,KAAAF,CACD,CACP,CAAK,EAEDD,EAAO,KAAK,GAAGQ,EAAS,KAAK,IAAI,EAEjCd,EAAc,UAAU,OAAO,WAAW,EAC1CD,EAAgB,UAAU,OAAO,WAAW,EAExCe,EAAS,KAAK,KAAK,OAASL,IAC9BV,EAAgB,UAAU,IAAI,WAAW,EACzCI,EAAO,UAAU,IAAI,WAAW,EAEnC,MAAC,CACAU,EAAS,MAAM,CACb,MAAO,QACP,QAAS,wCACf,CAAK,EACDb,EAAc,UAAU,OAAO,WAAW,CAC3C,CACH,CAEA,eAAegB,EAAaL,EAAc,GAAO,CAC/C,MAAMM,EAASX,EACZ,IAAIY,GACI;AAAA;AAAA,4CAE+BA,EAAI;AAAA;AAAA;AAAA,uBAGzBA,EAAI;AAAA,uBACJA,EAAI;AAAA;AAAA;AAAA;AAAA,SAKtB,EACA,KAAK,EAAE,EAQV,GANIP,EACFb,EAAU,UAAYmB,EAEtBnB,EAAU,mBAAmB,YAAamB,CAAM,EAG9CX,EAAO,SAAW,EACpB,OAAOO,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,kCACf,CAAK,EAGHT,EAAQ,QAAO,EAEf,MAAMe,EAAa,SAChB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAE3B,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEA,eAAeC,EAAWT,EAAc,GAAO,CAC7C,MAAMD,EAAaC,CAAW,EAC9B,MAAMK,EAAaL,CAAW,CAChC,CAEAT,EAAK,iBAAiB,SAAU,MAAMmB,GAAS,CAC7CA,EAAM,eAAc,EAEpBD,EAAW,EAAI,CACjB,CAAC,EAEDnB,EAAY,iBAAiB,QAAS,SAAY,CAChDmB,GACF,CAAC"}